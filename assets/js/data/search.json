---
layout: compress
---

[
  {% for post in site.posts %}
  {
    "id": "{{ post.url | replace: '/', '_' | replace: '-', '_' }}",
    "title": {{ post.title | jsonify }},
    "url": {{ post.url | relative_url | jsonify }},
    "categories": {{ post.categories | join: ', ' | jsonify }},
    "tags": {{ post.tags | join: ', ' | jsonify }},
    "date": {{ post.date | jsonify }},
    "content": {{ post.content | strip_html | strip_newlines | truncate: 10000 | jsonify }},
    "sections": [
      {% assign content_sections = post.content | split: '\n\n' %}
      {% for section in content_sections limit: 50 %}
        {% assign clean_section = section | strip_html | strip_newlines | truncate: 500 %}
        {% unless clean_section == blank %}
        {
          "id": "section_{{ forloop.index }}",
          "text": {{ clean_section | jsonify }},
          "html": {{ section | strip_newlines | jsonify }}
        }{% unless forloop.last %},{% endunless %}
        {% endunless %}
      {% endfor %}
    ]
  }{% unless forloop.last %},{% endunless %}
  {% endfor %}
]
